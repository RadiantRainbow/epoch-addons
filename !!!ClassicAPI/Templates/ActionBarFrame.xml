<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/
..\FrameXML\UI.xsd">
  <Frame name="ActionBarButtonSpellActivationAlert" virtual="true">
    <Layers>
      <Layer level="BACKGROUND">
        <Texture name="$parentSpark" parentKey="spark" file="Interface\AddOns\!!!ClassicAPI\Texture\SpellActivationOverlay\IconAlert" alpha="0" setAllPoints="true">
          <Anchors>
            <Anchor point="CENTER"/>
          </Anchors>
          <TexCoords left="0.00781250" right="0.61718750" top="0.00390625" bottom="0.26953125"/>
          <Animations>
            <AnimationGroup parentKey="animIn">
              <Alpha duration="0" change="0.3" order="1"/>
              <Scale duration="0.2" scaleX="1.5" scaleY="1.5" order="1"/>
              <Alpha duration="0.2" change="1" order="1"/>
              <Scale startDelay="0.2" duration="0.2" scaleX="0.666666" scaleY="0.666666" order="1"/>
              <Alpha startDelay="0.2" duration="0.2" change="-1" order="1"/>
            </AnimationGroup>
          </Animations>
        </Texture>
      </Layer>
      <Layer level="ARTWORK">
        <Texture name="$parentInnerGlow" parentKey="innerGlow" file="Interface\AddOns\!!!ClassicAPI\Texture\SpellActivationOverlay\IconAlert" alpha="0" setAllPoints="true">
          <Anchors>
            <Anchor point="CENTER"/>
          </Anchors>
          <TexCoords left="0.00781250" right="0.50781250" top="0.27734375" bottom="0.52734375"/>
          <Animations>
            <AnimationGroup parentKey="animIn">
              <Alpha duration="0" change="1" order="1"/>
              <Scale duration="0.3" scaleX="2" scaleY="2" order="1"/>
              <Alpha startDelay="0.3" duration="0.2" change="-1" order="1"/>
            </AnimationGroup>
          </Animations>
        </Texture>
        <Texture name="$parentInnerGlowOver" parentKey="innerGlowOver" file="Interface\AddOns\!!!ClassicAPI\Texture\SpellActivationOverlay\IconAlert" alpha="0">
          <Anchors>
            <Anchor point="TOPLEFT" relativeTo="$parentInnerGlow" relativePoint="TOPLEFT"/>
            <Anchor point="BOTTOMRIGHT" relativeTo="$parentInnerGlow" relativePoint="BOTTOMRIGHT"/>
          </Anchors>
          <TexCoords left="0.00781250" right="0.50781250" top="0.53515625" bottom="0.78515625"/>
          <Animations>
            <AnimationGroup parentKey="animIn">
              <Alpha duration="0" change="1" order="1"/>
              <Scale duration="0.3" scaleX="2" scaleY="2" order="1"/>
              <Alpha duration="0.3" change="-1" order="1"/>
            </AnimationGroup>
          </Animations>
        </Texture>
        <Texture name="$parentOuterGlow" parentKey="outerGlow" file="Interface\AddOns\!!!ClassicAPI\Texture\SpellActivationOverlay\IconAlert" hidden="true" setAllPoints="true">
          <Anchors>
            <Anchor point="CENTER"/>
          </Anchors>
          <TexCoords left="0.00781250" right="0.50781250" top="0.27734375" bottom="0.52734375"/>
          <Animations>
            <AnimationGroup parentKey="animIn">
              <Scale duration="0.3" endDelay="0.3" scaleX="0.5" scaleY="0.5" order="1"/>
            </AnimationGroup>
            <AnimationGroup parentKey="animOut">
              <Alpha duration="0.2" startDelay="0.2" change="-1" order="1"/>
            </AnimationGroup>
          </Animations>
        </Texture>
        <Texture name="$parentOuterGlowOver" parentKey="outerGlowOver" file="Interface\AddOns\!!!ClassicAPI\Texture\SpellActivationOverlay\IconAlert" alpha="0">
          <Anchors>
            <Anchor point="TOPLEFT" relativeTo="$parentOuterGlow" relativePoint="TOPLEFT"/>
            <Anchor point="BOTTOMRIGHT" relativeTo="$parentOuterGlow" relativePoint="BOTTOMRIGHT"/>
          </Anchors>
          <TexCoords left="0.00781250" right="0.50781250" top="0.53515625" bottom="0.78515625"/>
          <Animations>
            <AnimationGroup parentKey="animIn">
              <Alpha duration="0" change="1" order="1"/>
              <Scale duration="0.3" scaleX="0.5" scaleY="0.5" order="1"/>
              <Alpha duration="0.3" change="-1" order="1"/>
            </AnimationGroup>
            <AnimationGroup parentKey="animOut">
              <Alpha duration="0.2" change="1" order="1"/>
              <Alpha duration="0.2" change="-1" order="2"/>
            </AnimationGroup>
          </Animations>
        </Texture>
      </Layer>
      <Layer level="OVERLAY">
        <Texture name="$parentAnts" parentKey="ants" file="Interface\AddOns\!!!ClassicAPI\Texture\SpellActivationOverlay\IconAlertAnts" hidden="true" setAllPoints="true">
          <Anchors>
            <Anchor point="CENTER"/>
          </Anchors>
          <Animations>
            <AnimationGroup parentKey="animIn">
              <Alpha duration="0" change="-1" order="1"/>
              <Alpha startDelay="0.3" duration="0.2" change="1" order="1"/>
            </AnimationGroup>
            <AnimationGroup parentKey="animOut">
              <Alpha duration="0.2" endDelay="0.2" change="-1" order="1"/>
            </AnimationGroup>
          </Animations>
        </Texture>
      </Layer>
    </Layers>
    <Animations>
      <AnimationGroup parentKey="animIn">
        <Animation duration="0.6"/>
        <Scripts>
          <OnPlay>
            local frame = self:GetParent()
            local frameWidth, frameHeight = frame:GetSize()
            frame.spark:SetSize(frameWidth, frameHeight)
            frame.innerGlow:SetSize(frameWidth / 2, frameHeight / 2)
            frame.outerGlow:SetSize(frameWidth * 2, frameHeight * 2)
            frame.outerGlow:Show()
            frame.ants:SetSize(frameWidth * 0.85, frameHeight * 0.85)
            frame.ants:Show()
            frame:Show()

            frame.spark.animIn:Play()
            frame.innerGlow.animIn:Play()
            frame.innerGlowOver.animIn:Play()
            frame.outerGlow.animIn:Play()
            frame.outerGlowOver.animIn:Play()
            frame.ants.animIn:Play()
          </OnPlay>
          <OnStop function="ActionButton_OverlayGlowAnimInFinished"/>
          <OnFinished function="ActionButton_OverlayGlowAnimInFinished"/>
        </Scripts>
      </AnimationGroup>
      <AnimationGroup parentKey="animOut">
        <Animation duration="0.4"/>
        <Scripts>
          <OnPlay>
            local frame = self:GetParent()
            frame.outerGlowOver.animOut:Play()
            frame.outerGlow.animOut:Play()
            frame.ants.animOut:Play()
          </OnPlay>
          <OnStop>
            local frame = self:GetParent()
            frame.outerGlow:Hide()
            frame.ants:Hide()

            frame.outerGlowOver.animOut:Stop()
            frame.outerGlow.animOut:Stop()
            frame.ants.animOut:Stop()
          </OnStop>
          <OnFinished function="ActionButton_OverlayGlowAnimOutFinished"/>
        </Scripts>
      </AnimationGroup>
    </Animations>
    <Scripts>
      <OnUpdate function="ActionButton_OverlayGlowOnUpdate"/>
      <OnHide>
        if ( self:GetParent().overlay ) then
          self.animIn:Stop()
          self.animOut:Stop()
          ActionButton_OverlayGlowAnimOutFinished(self.animOut)
        end
      </OnHide>
    </Scripts>
  </Frame>
</Ui>